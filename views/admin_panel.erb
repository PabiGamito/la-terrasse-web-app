<% if @logged_in %>
<link rel="stylesheet" href="/css/bootstrap.min.css">
<script src="/js/jquery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<link rel="stylesheet" href="/css/main.css">

<!-- TODO: Option to close orders for different reasons-->
<header id="header">
  <nav id="main-menu" class="navbar navbar-default navbar-fixed-top" role="banner" style="background-color:#f2eee3">
    <div class="container">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="/"><img src="images/logo.png" alt="La Terrasse de Saint Germain au mont d'Or" style="height:100px;margin:-20px">
        </a>
      </div>

      <div class="collapse navbar-collapse navbar-right">
        <ul class="nav navbar-nav">
          <li>
            <a href="#todo">Commandes à préparer</a>
          </li>
          <li>
            <a href="#done">Commandes déjà prêtes</a>
          </li>
          <li>
            <a href="#done">Changer le mot de passe</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>
</header>

<div class="show-orders wood-background" style="min-height:100vh; margin-top:-100px; padding-top:150px;">
  <%= erb :admin_show_orders %>
</div>

<script type="text/javascript">
  $("body").on("click", ".completed", function(){
    $.post(
      "/order-completed",{
  			order_id: $(this).attr("order-id")
  		},
      function(data) {
        // On answer
        $(".show-orders").html(data);
      }
    );
  });

  $("body").on("click", ".uncompleted", function(){
    $.post(
      "/order-uncompleted",{
  			order_id: $(this).attr("order-id")
  		},
      function(data) {
        // On answer
        $(".show-orders").html(data);
      }
    );
  });

  // Hide/show sections based on url hash value
  if (window.location.hash === "") {
    $("section#todo").show();
    $(".nav li a[href=#todo]").parent().addClass("active");
  } else {
    $("section"+window.location.hash).show();
    $(".nav li a[href="+window.location.hash+"]").parent().addClass("active");
  }

  $(".nav li").click(function(){
    if (!$(this).hasClass("active")) {
      $("section"+$(".nav li.active").find("a").attr("href")).hide();
      $(".nav li.active").removeClass("active");
      $("section"+$(this).find("a").attr("href")).show();
      $(this).addClass("active");
    }
  });

setInterval(function(){
  $.get("/show-orders", function(data) {
      // On answer
      $(".show-orders").html(data);
    }
  );
}, 1000*60);

</script>

<% else %>
<link href='https://fonts.googleapis.com/css?family=Roboto:500,400,300' rel='stylesheet' type='text/css'>
<style media="screen">
.container {
  background: white;
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 260px;
  text-align: center;
  padding: 45px;
  box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2);
  font-family: "Roboto", sans-serif;
}

.form input, .form select {
  font-family: "Roboto", sans-serif;
  outline: 0;
  background: #f2f2f2;
  width: 100%;
  border: 0;
  margin: 0 0 15px;
  padding: 15px;
  box-sizing: border-box;
  font-size: 14px;
  border-radius: 5px;
  color: #333333;
  font-weight: 500;
  /*text-align: center;*/
}
.form label {
  color: #333333;
  font-size: 12px;
  float: left;
  padding-left: 5px;
  font-weight: 300;
  /*text-align: center;*/
}
.form button {
  font-family: "Roboto", sans-serif;
  text-transform: uppercase;
  outline: 0;
  background: #c4b58a;
  border: 0;
  width: 100%;
  padding: 15px;
  color: #FFFFFF;
  font-size: 14px;
  -webkit-transition: all 0.3 ease;
  transition: all 0.3 ease;
  cursor: pointer;
  margin-top: 25px;
}
.form button:hover {
  background: #89644d;
}
.form .bottom {
  font-size: 12px;
  color: #3e3e3e;
}
.form a {
  color: #4CAF50;
  text-decoration: inherit;
}
</style>

<section class="container">
  <form class="form" action="admin-login" method="post">
    <label for="username">Nom d'utilisateur</label>
    <input type="text" name="username">
    <label for="password">Mot de passe</label>
    <input type="password" name="password">
    <button type="submit">S'identifier</button>
  </form>
</section>

<% end %>
